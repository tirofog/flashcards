<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CSV to PDF Converter</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <h1>CSV to PDF Converter</h1>
  <form id="csvForm">
    <label for="csvFile">Upload CSV File:</label>
    <input type="file" id="csvFile" accept=".csv" required>
    <br><br>
    <label for="rowsPerPage">Rows Per Page:</label>
    <input type="number" id="rowsPerPage" min="1" value="10" required>
    <br><br>
    <button type="submit">Convert to PDF</button>
  </form>
  <script>
    document.getElementById('csvForm').addEventListener('submit', async function(event) {
      event.preventDefault();

      const file = document.getElementById('csvFile').files[0];
      const rowsPerPage = parseInt(document.getElementById('rowsPerPage').value, 10);

      if (!file) {
        alert('Please upload a CSV file.');
        return;
      }

      // Parse the CSV file
      Papa.parse(file, {
        complete: function(results) {
          const data = results.data;

          // Validate CSV content
          if (data.length < 1 || data[0].length !== 2) {
            alert('The CSV file must have exactly two columns.');
            return;
          }

          generatePDF(data, rowsPerPage);
        },
        error: function(error) {
          alert('Error parsing CSV: ' + error.message);
        }
      });
    });

    function generatePDF(data, rowsPerPage) {
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF();

      const pageWidth = pdf.internal.pageSize.getWidth();
      const pageHeight = pdf.internal.pageSize.getHeight();
      const margin = 10;
      const usableWidth = pageWidth - margin * 2;
      const usableHeight = pageHeight - margin * 2;

      const rowHeight = usableHeight / rowsPerPage;
      const colWidths = [usableWidth * 0.5, usableWidth * 0.5];

      let currentRow = 0;
      let page = 1;

      for (let i = 0; i < data.length; i++) {
        const row = data[i];

        // Add new page if needed
        if (currentRow >= rowsPerPage) {
          pdf.addPage();
          currentRow = 0;
          page++;
        }

        const y = margin + currentRow * rowHeight;

        // Draw columns
        pdf.text(row[0], margin, y + rowHeight / 2, { baseline: 'middle', maxWidth: colWidths[0] });
        pdf.text(row[1], margin + colWidths[0], y + rowHeight / 2, { baseline: 'middle', maxWidth: colWidths[1] });

        currentRow++;
      }

      // Save the PDF
      pdf.save('output.pdf');
    }
  </script>
</body>
</html>
